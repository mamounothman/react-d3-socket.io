<!doctype html>
<html>
  <head>
    <title>D3js, React, and Socket.io</title>
    <style>
        path {
            fill: none;
            stroke: #aaa;
        }
        .start {
            border: 1px solid #000;
            padding: 5px 10px;
        }
    </style>
  </head>
  <body>
     <div id="app"><a class="start">Start</a></div> 
    <!-- <svg width="1000" height="100">
		<path transform="translate(200, 0)" />
	</svg> -->
    <!-- <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form> -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.js"></script>
    <script src="//d3js.org/d3.v3.min.js"></script>
    <script>
        $(function(){
            var setp = 1;
            $('a.start').click(function(){
                clearInterval(pingInterval);
                transition(setp);
            });

            var socket = io('http://ec2-34-212-134-187.us-west-2.compute.amazonaws.com:9090');
            socket.on('widget:data', function(data){
                var entries = JSON.parse(data.message).Root.BinaryInSet.Entry;
                entries.forEach(function(Entry) {
                    //console.log(Entry.Value);
                    if(Entry.Value == 1) {
                        //console.log(Entry);
                    }
                });
            });


            var data = [[180, 200], [280, 200], [380, 200],[480, 200],[580, 200],[680, 200],[780, 200]];
            var svg = d3.select("body").append("svg")
                .attr("width", 960)
                .attr("height", 500);

            var path = svg.append("path")
                .data([data])
                .attr("d", d3.svg.line()); // Catmullâ€“Rom
                    // .interpolate("cardinal-closed"));

            svg.selectAll(".point")
                .data(data)
                .enter().append("circle")
                .attr("r", 5)
                .attr("transform", function(d) { return "translate(" + d + ")"; });

            var circle = svg.append("circle")
                .attr("r", 5)
                .attr("transform", "translate(" + data[0] + ")")

            function ping() {
                var translate = d3.transform(circle.attr('transform'));
                svg.append('circle')
                    .transition()
                    .attr({
                        'cx': translate.translate[0],
                        'cy': translate.translate[1],
                        'r': 1,
                        'stroke': 'red',
                        'stroke-opacity': 1,
                        'stroke-width': '3px',
                        // "transform": "translate(" + data[0] + ")"
                    })
                    .transition()
                    .duration(3000)
                    .attr({
                        'fill': 'none',
                        'r': 35,
                        'stroke': '#369',
                        'stroke-width': '0px',
                        'stroke-opacity': 0,
                        'class' : 'finised'
                    })
                };
                var pingInterval = setInterval(ping, 300);

                //circle.transition().duration(1000).ease("linear").attr("transform", "translate(180, 200)")
        });
    </script>
  </body>
</html>